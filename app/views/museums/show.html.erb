<%= stylesheet_link_tag 'museum_show', :media => "all" %>

<div class="museum-show-container">
  <!-- уГСуГ│уБПуБЪуГкуВ╣уГИ -->
  <nav class="breadcrumb">
    <%= link_to "уГЫуГ╝уГа", journals_path, class: "breadcrumb-link" %> / 
    <%= link_to "хНЪчЙйщдицдЬч┤в", museums_path, class: "breadcrumb-link" %> / 
    <span class="breadcrumb-current"><%= truncate(@museum.name, length: 30) %></span>
  </nav>

  <div class="museum-grid">
    <!-- уГбуВдуГ│уВ│уГ│уГЖуГ│уГД -->
    <div class="main-content">
      <!-- хНЪчЙйщдицГЕха▒уВлуГ╝уГЙ -->
      <div class="museum-info-card">
        <h1 class="museum-title">
          <%= @museum.name %>
        </h1>

        <!-- хЯ║цЬмцГЕха▒ -->
        <div class="museum-details">
          <div class="detail-item">
            <span class="detail-icon">ЁЯУН</span>
            <div class="detail-content">
              <p class="detail-label">цЙАхЬихЬ░</p>
              <p class="detail-value"><%= @museum.full_address %></p>
            </div>
          </div>

          <% if @museum.museum_type.present? %>
            <div class="detail-item">
              <span class="detail-icon">ЁЯПЫя╕П</span>
              <div class="detail-content">
                <p class="detail-label">щдичио</p>
                <p class="detail-value"><%= @museum.museum_type %></p>
              </div>
            </div>
          <% end %>

          <% if @museum.registration_type.present? %>
            <div class="detail-item">
              <span class="detail-icon">тЬУ</span>
              <div class="detail-content">
                <p class="detail-label">чЩ╗щМ▓хМ║хИЖ</p>
                <p class="detail-value"><%= @museum.registration_type %></p>
              </div>
            </div>
          <% end %>

          <% if @museum.official_website.present? %>
            <div class="detail-item">
              <span class="detail-icon">ЁЯМР</span>
              <div class="detail-content">
                <p class="detail-label">хЕмх╝ПуВ╡уВдуГИ</p>
                <%= link_to @museum.official_website, 
                           @museum.official_website, 
                           target: "_blank", 
                           class: "detail-link" %>
              </div>
            </div>
          <% end %>
        </div>

        <!-- ч╡▒шиИцГЕха▒ -->
        <div class="museum-stats">
          <div class="stat-box">
            <p class="stat-number"><%= @museum.visit_count || 0 %></p>
            <p class="stat-label">шикхХПцХ░</p>
          </div>
          <div class="stat-box">
            <p class="stat-number"><%= @journals_count || 0 %></p>
            <p class="stat-label">цЧешиШцКХчи┐</p>
          </div>
        </div>

        <!-- уВвуВпуВ╖уГзуГ│уГЬуВ┐уГ│ -->
        <div class="museum-action">
          <%= link_to new_journal_path(museum_id: @museum.id), 
                     class: "btn-write-journal" do %>
            <span class="btn-icon">тЬПя╕П</span>
            <span>уБУуБохНЪчЙйщдиуБоцЧешиШуВТцЫ╕уБП</span>
          <% end %>
        </div>
      </div>

      <!-- щЦвщАгцЧешиШуВ╗уВпуВ╖уГзуГ│ -->
      <div class="journals-section">
        <h2 class="journals-section-title">
          уБУуБохНЪчЙйщдиуБоцЧешиШ (<%= @journals_count || 0 %>ф╗╢)
        </h2>

        <% if @related_journals && @related_journals.any? %>
          <div class="journals-list">
            <% @related_journals.each do |journal| %>
              <div class="journal-item">
                <%= link_to journal_path(journal), class: "journal-item-link" do %>
                  <div class="journal-item-header">
                    <h3 class="journal-item-title">
                      <%= truncate(journal.body.presence || "цЧешиШ ##{journal.id}", length: 50) %>
                    </h3>
                    <% if journal.rate.present? %>
                      <div class="journal-item-rating">
                        <% journal.rate.times do %>
                          <span class="star">тШЕ</span>
                        <% end %>
                      </div>
                    <% end %>
                  </div>
                  <% if journal.visit_date.present? %>
                    <p class="journal-item-date">
                      шикхХПцЧе: <%= journal.visit_date.strftime('%Yх╣┤%mцЬИ%dцЧе') %>
                    </p>
                  <% end %>
                  <% if journal.body.present? %>
                    <p class="journal-item-body">
                      <%= truncate(journal.body, length: 150) %>
                    </p>
                  <% end %>
                  <p class="journal-item-author">
                    by <%= journal.user.email.split('@').first %>
                  </p>
                <% end %>
              </div>
            <% end %>
          </div>

          <% if @journals_count && @journals_count > 10 %>
            <div class="view-all-journals">
              <%= link_to "уБЩуБ╣уБжуБоцЧешиШуВТшжЛуВЛ (#{@journals_count}ф╗╢)", 
                         journals_path(museum_id: @museum.id), 
                         class: "view-all-link" %>
            </div>
          <% end %>
        <% else %>
          <div class="empty-journals">
            <span class="empty-icon">ЁЯУЭ</span>
            <p class="empty-text">уБ╛уБацЧешиШуБМцКХчи┐уБХуВМуБжуБДуБ╛уБЫуВУ</p>
            <%= link_to "цЬАхИЭуБоцЧешиШуВТцЫ╕уБП", 
                       new_journal_path(museum_id: @museum.id), 
                       class: "btn-first-journal" %>
          </div>
        <% end %>
      </div>
    </div>

    <!-- уВ╡уВдуГЙуГРуГ╝ -->
    <div class="sidebar">
      <!-- хРМуБШщГ╜щБУх║ЬчЬМуБохНЪчЙйщди -->
      <div class="sidebar-card">
        <h3 class="sidebar-title">
          <%= @museum.prefecture %>уБоф╗ЦуБохНЪчЙйщди
        </h3>
        <%= link_to "#{@museum.prefecture}уБохНЪчЙйщдиуВТцОвуБЩ", 
                   museums_path(prefecture: @museum.prefecture), 
                   class: "sidebar-btn" %>
      </div>

      <!-- хРМуБШщдичиоуБохНЪчЙйщди -->
      <% if @museum.museum_type.present? %>
        <div class="sidebar-card">
          <h3 class="sidebar-title">
            <%= @museum.museum_type %>щдиуВТцОвуБЩ
          </h3>
          <%= link_to "хЕихЫ╜уБо#{@museum.museum_type}щди", 
                     museums_path(museum_type: @museum.museum_type), 
                     class: "sidebar-btn" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
